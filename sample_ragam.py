import argparse
import random

parser = argparse.ArgumentParser(description='Sample ragalu by how common they are.')
parser.add_argument('-t', '--temperature', type=float, default=1, help="""Temperature for sampling. Example values:
'-t=0.5 upweights more common ragalu (easy mode)
'-t=1 samples the true distribution (concert simulation mode)
'-t=3 upweights less common ragalu somewhat (medium mode)
'-t=100 samples all equally (hard mode).
'-t=-3 You think you're clever, huh? This means that the less common a raga is in real life, the more likely you are to sample it (extra hard mode).""")
parser.add_argument('-n', '--n', type=int, default=1, help="how many to generate")
parser.add_argument('-r', '--raga_list', type=str, default="v1",  help="which raga list to use. TBH I am not sure what the difference between them really is.")

args = parser.parse_args()


# v1: tries to get at concerts by ensuring 6+ ragas per post.
# Posts with at least six raga mentions: 2888/4871
# get_all_mentions(post, one_of_each=True, minimum_raga_mentions_per_page=6, minimum_post_chars = 500)
#
# v2: total number of mentions
# Posts with at least three raga mentions: 3820/4871
# get_all_mentions(post, one_of_each=False, minimum_raga_mentions_per_page=3, minimum_post_chars = 100)
raga_frequencies = {
'v1': [('kalyani', 1226), ('todi', 1113), ('ragamalika', 1076), ('bairavi', 1067), ('kamboji', 946), ('mohanam', 884), ('kapi', 793), ('shankarabaranam', 773), ('sindubairavi', 769), ('sama', 746), ('shriraga', 721), ('behag', 696), ('natta', 673), ('saveri', 644), ('sahana', 633), ('bilahari', 624), ('kamas', 609), ('madyamavati', 595), ('karaharapriya', 595), ('begada', 584), ('kanada', 540), ('hindolam', 538), ('surutti', 536), ('varali', 527), ('pantuvarali', 526), ('shanmukapriya', 523), ('kannada', 516), ('purvikalyani', 509), ('anandabairavi', 492), ('hamsadwani', 470), ('vasanta', 464), ('ritigaula', 462), ('hamsanandi', 453), ('danyasi', 424), ('sarashwati', 418), ('mukari', 396), ('kiravani', 391), ('arabi', 383), ('ranjani', 383), ('natakurinji', 375), ('atana', 365), ('lalita', 364), ('nilambari', 356), ('saurashtram', 344), ('saranga', 337), ('mayamalavagaula', 335), ('shriranjani', 327), ('kedaragaula', 322), ('darbar', 294), ('abogi', 282), ('revati', 279), ('desh', 278), ('yamunakalyani', 271), ('hamirkalyani', 268), ('devagandari', 258), ('charukesi', 258), ('kedaram', 247), ('kuntalavarali', 245), ('nalinakanti', 241), ('dwijavanti', 241), ('bageshri', 232), ('yadukulakamboji', 228), ('valachi', 215), ('aberi', 214), ('gaula', 211), ('jonpuri', 207), ('senchurutti', 205), ('mand', 205), ('ahiri', 202), ('bauli', 199), ('bahudari', 197), ('huseni', 192), ('brindavanasaranga', 190), ('harikamboji', 184), ('gauri', 180), ('asaveri', 179), ('nadanamapriya', 176), ('nayaki', 176), ('kurunji', 174), ('latangi', 170), ('amritavarshini', 168), ('suddadanyasi', 167), ('faras', 156), ('mohanakalyani', 153), ('suddasaveri', 152), ('chakravakam', 151), ('ganapatim', 151), ('punnagavarali', 150), ('shivaranjani', 149), ('saramati', 142), ('subapantuvarali', 142), ('hamsanadam', 142), ('durga', 141), ('malayamarutam', 139), ('kalyanavasantam', 138), ('surya', 137), ('maduvanti', 135), ('simhendramadyamam', 134), ('ramapriya', 130), ('darmavati', 129), ('manirangu', 128), ('jaganmohini', 128), ('janaranjani', 124), ('purnachandrika', 123), ('vachaspati', 123), ('narayani', 122), ('tilang', 122), ('gaurimanohari', 117), ('brindavani', 114), ('darbarikanada', 112), ('andolika', 109), ('rasikapriya', 107), ('hemavati', 107), ('malavi', 106), ('denuka', 105), ('kannadagaula', 103), ('purvi', 103), ('narayanagaula', 102), ('devamanohari', 100), ('mandara', 99), ('kalavati', 99), ('natabairavi', 98), ('padi', 97), ('manji', 91), ('kanta', 89), ('varamu', 88), ('bupalam', 87), ('sarasangi', 86), ('pilu', 80), ('chandrakauns', 80), ('kamalamanohari', 78), ('chauka', 77), ('kapinarayani', 77), ('jog', 76), ('gaulipantu', 75), ('bindumalini', 74), ('malahari', 73), ('chandrajyoti', 72), ('mandari', 70), ('karnaranjani', 69), ('taranjani', 68), ('bavani', 66), ('revagupti', 63), ('ganamurti', 62), ('nasikabushani', 62), ('vakulabaranam', 62), ('jayantashri', 60), ('sumanasaranjani', 60), ('kanakangi', 60), ('vagadishwari', 58), ('ganta', 56), ('natakapriya', 49), ('vasantam', 48), ('kumudapriya', 46), ('rishabapriya', 45), ('suryakantam', 44), ('rupavati', 43), ('kadanakutuhalam', 43), ('devapriya', 43), ('vegavahini', 42), ('vasanti', 42), ('garudadwani', 42), ('rudrapriya', 42), ('vijayashri', 41), ('seshadri', 41), ('nitimati', 40), ('nagashwarali', 40), ('hamsavinodini', 39), ('pavani', 39), ('gamakapriya', 39), ('navarasakanada', 38), ('suddasarang', 38), ('udayaravichandrika', 37), ('chalanatta', 35), ('kokilapriya', 35), ('ratipatipriya', 34), ('purnashadjam', 33), ('jayamanohari', 33), ('mahati', 32), ('kosalam', 32), ('manjari', 31), ('gamanashrama', 31), ('kantamani', 30), ('karnatakakapi', 30), ('vijayanagari', 29), ('vanaspati', 28), ('navroj', 28), ('rasali', 27), ('kalgada', 27), ('sunadavinodini', 26), ('hindustanikapi', 25), ('niroshta', 25), ('yagapriya', 25), ('bushavali', 23), ('gambiranatta', 23), ('sohini', 21), ('lavangi', 20), ('viravasantam', 19), ('nariritigaula', 18), ('megaranjani', 18), ('chayatarangini', 17), ('gaudamalhar', 17), ('rakeshri', 17), ('samanta', 16), ('karnatakasuddasaveri', 16), ('ratnangi', 14), ('varunapriya', 14), ('tanarupi', 14), ('janasammodini', 14), ('nagagandari', 12), ('vandanadarini', 12), ('vardini', 12), ('bimpalas', 11), ('chitrambari', 11), ('nadabrahma', 11), ('jingala', 10), ('nasamani', 10), ('urmika', 10), ('rohini', 10), ('deshyatodi', 10), ('ragavardini', 10), ('supradipam', 8), ('hindustanitodi', 8), ('katyayani', 8), ('ramkali', 8), ('ragupriya', 8), ('suposhini', 7), ('hindustanibehag', 6), ('budamanohari', 6), ('datuvardani', 5), ('gaurivelavali', 5), ('gopriya', 5), ('hindolavasanta', 4), ('cayaranjani', 4), ('ravipriya', 4), ('buvanagandari', 3), ('ragavinodini', 3), ('mishrakapi', 2), ('suraranjani', 2), ('rasavinodini', 1), ('janatodi', 1), ('ratnakanti', 1), ('margadeshi', 1)],
'v2': [('kalyani', 3758), ('todi', 3698), ('bairavi', 3212), ('ragamalika', 2697), ('kamboji', 2630), ('mohanam', 2307), ('shriraga', 2134), ('kapi', 2025), ('shankarabaranam', 1928), ('bilahari', 1794), ('sama', 1673), ('sahana', 1624), ('saveri', 1602), ('natta', 1551), ('sindubairavi', 1531), ('begada', 1456), ('karaharapriya', 1446), ('behag', 1421), ('kannada', 1396), ('kamas', 1336), ('pantuvarali', 1296), ('varali', 1260), ('shanmukapriya', 1237), ('madyamavati', 1221), ('purvikalyani', 1186), ('hindolam', 1175), ('kanada', 1156), ('kiravani', 1143), ('surutti', 1114), ('ritigaula', 1094), ('vasanta', 1081), ('lalita', 1060), ('anandabairavi', 1060), ('mukari', 1055), ('sarashwati', 1018), ('hamsadwani', 959), ('hamsanandi', 911), ('danyasi', 848), ('arabi', 800), ('natakurinji', 796), ('nilambari', 784), ('shriranjani', 764), ('ranjani', 761), ('saranga', 721), ('atana', 721), ('darbar', 710), ('kedaram', 662), ('kedaragaula', 643), ('desh', 620), ('abogi', 613), ('revati', 590), ('mayamalavagaula', 558), ('devagandari', 551), ('charukesi', 551), ('saurashtram', 519), ('yamunakalyani', 505), ('dwijavanti', 502), ('aberi', 500), ('hamirkalyani', 471), ('nalinakanti', 467), ('kuntalavarali', 452), ('bageshri', 446), ('valachi', 426), ('gauri', 425), ('ahiri', 423), ('latangi', 421), ('huseni', 399), ('brindavanasaranga', 398), ('nayaki', 391), ('asaveri', 390), ('yadukulakamboji', 389), ('bahudari', 382), ('mand', 371), ('senchurutti', 370), ('durga', 363), ('kalyanavasantam', 362), ('ramapriya', 359), ('harikamboji', 353), ('surya', 352), ('bauli', 345), ('faras', 340), ('jonpuri', 337), ('amritavarshini', 333), ('suddadanyasi', 328), ('nadanamapriya', 322), ('chakravakam', 320), ('kurunji', 314), ('saramati', 307), ('hamsanadam', 303), ('suddasaveri', 302), ('gaula', 298), ('shivaranjani', 293), ('maduvanti', 293), ('padi', 292), ('mohanakalyani', 290), ('darmavati', 288), ('kalavati', 281), ('subapantuvarali', 278), ('ganapatim', 267), ('gaurimanohari', 266), ('narayanagaula', 265), ('natabairavi', 263), ('punnagavarali', 259), ('jaganmohini', 248), ('varamu', 246), ('malayamarutam', 245), ('hemavati', 245), ('narayani', 241), ('denuka', 240), ('janaranjani', 239), ('manirangu', 237), ('andolika', 233), ('devamanohari', 227), ('rasikapriya', 221), ('sarasangi', 220), ('vachaspati', 214), ('simhendramadyamam', 211), ('manji', 203), ('purnachandrika', 200), ('brindavani', 200), ('tilang', 200), ('malavi', 192), ('mandara', 190), ('bupalam', 190), ('sumanasaranjani', 189), ('chandrakauns', 186), ('kanta', 181), ('jog', 178), ('darbarikanada', 173), ('bavani', 169), ('pilu', 168), ('taranjani', 163), ('mandari', 159), ('kannadagaula', 155), ('purvi', 152), ('malahari', 150), ('bindumalini', 148), ('ganta', 148), ('kamalamanohari', 136), ('kapinarayani', 135), ('karnaranjani', 132), ('revagupti', 131), ('gaulipantu', 128), ('chauka', 125), ('chandrajyoti', 125), ('gamakapriya', 125), ('vakulabaranam', 122), ('natakapriya', 115), ('rupavati', 111), ('ganamurti', 107), ('kanakangi', 107), ('vagadishwari', 105), ('kumudapriya', 102), ('nasikabushani', 98), ('rishabapriya', 96), ('udayaravichandrika', 94), ('suddasarang', 92), ('rasali', 91), ('vegavahini', 89), ('hamsavinodini', 88), ('seshadri', 88), ('rudrapriya', 86), ('mahati', 85), ('vasanti', 84), ('purnashadjam', 83), ('jayantashri', 82), ('garudadwani', 82), ('karnatakakapi', 80), ('suryakantam', 77), ('kosalam', 76), ('devapriya', 76), ('niroshta', 71), ('gamanashrama', 70), ('pavani', 69), ('chalanatta', 68), ('kantamani', 67), ('kokilapriya', 65), ('ratipatipriya', 65), ('nitimati', 64), ('vasantam', 63), ('sunadavinodini', 61), ('vijayanagari', 60), ('kadanakutuhalam', 58), ('manjari', 58), ('vanaspati', 57), ('vijayashri', 55), ('jayamanohari', 54), ('nagashwarali', 54), ('hindustanikapi', 54), ('yagapriya', 52), ('navarasakanada', 51), ('kalgada', 51), ('navroj', 49), ('samanta', 44), ('gambiranatta', 38), ('megaranjani', 37), ('bushavali', 35), ('lavangi', 34), ('viravasantam', 34), ('chitrambari', 33), ('rakeshri', 31), ('rohini', 30), ('sohini', 29), ('nariritigaula', 29), ('karnatakasuddasaveri', 27), ('gaudamalhar', 25), ('nadabrahma', 25), ('janasammodini', 25), ('jingala', 24), ('varunapriya', 24), ('urmika', 23), ('vardini', 23), ('bimpalas', 21), ('chayatarangini', 21), ('tanarupi', 20), ('deshyatodi', 20), ('nagagandari', 18), ('ratnangi', 18), ('gopriya', 18), ('ragavardini', 17), ('nasamani', 16), ('hindustanitodi', 16), ('katyayani', 15), ('vandanadarini', 14), ('supradipam', 13), ('suposhini', 13), ('gaurivelavali', 13), ('ravipriya', 12), ('cayaranjani', 11), ('ratnakanti', 11), ('ramkali', 9), ('ragupriya', 9), ('suraranjani', 8), ('hindustanibehag', 7), ('ragavinodini', 7), ('budamanohari', 6), ('datuvardani', 5), ('hindolavasanta', 4), ('buvanagandari', 4), ('mishrakapi', 4), ('rasavinodini', 3), ('janatodi', 3), ('margadeshi', 1)]
}


# Both of these downweight Shree, Ranjani, and Kannada, and remove ragamalika
def update_count(update_dict):
  for version in update_dict:
    frequency_dict = dict(raga_frequencies[version])
    for ragam, new_ct in update_dict[version].items():
        assert ragam in frequency_dict
        frequency_dict[ragam] = new_ct
    raga_frequencies[version] = list(frequency_dict.items())

update_count({'v1': {'ragamalika': 0, 'shriraga': 500, 'ranjani': 100, 'kannada': 70},  'v2': {'ragamalika': 0, 'shriraga': 1000, 'ranjani': 200, 'kannada': 140}})

frequencies = sorted(raga_frequencies[args.raga_list], key=lambda x: -x[1])
frequencies = [(ragam, count) for ragam, count in frequencies if count > 0]
z = sum([ct for name, ct in frequencies])
names, counts =  zip(*frequencies)
weights = [(count/z)**(1.0/args.temperature) for count in counts]

choices = random.choices(names, weights=weights, k=args.n)
print("\n".join(choices))
